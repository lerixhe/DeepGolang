# 查看程序内存占用

## 准备工作

1.循环append切片，占用内存
2.程序sleep

```golang
func main() {
	log.Print("Start ...")
	test()
	log.Print("Done ...")
	time.Sleep(3600 * time.Second)
}
```

## 使用top命令查看内存占用

```shell
top -p $(pidof test2_Mem)
```

发现程序运行后，占用大量内存5.7%，运行一段时间后，内存逐渐释放到0.3%。

## 使用gc回收内存

```golang
func main() {
	log.Print("Start ...")
	test()
	log.Print("Force GC after 10s...")
	time.Sleep(10 * time.Second)
	runtime.GC()
	log.Print("Done ...")
    time.Sleep(3600 * time.Second)
}
```

发现主动gc与被动没啥明显区别，待进一步分析原因 
TODO
